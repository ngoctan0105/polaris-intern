"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.build = exports.LifecycleNames = void 0;
const utils_1 = require("../utils");
const utils_2 = require("../utils");
exports.LifecycleNames = [
    "beforeCreate",
    "created",
    "beforeMount",
    "mounted",
    "beforeUpdate",
    "updated",
    "activated",
    "deactivated",
    "beforeDestroy",
    "beforeUnmount",
    "destroyed",
    "unmounted",
    "renderTracked",
    "renderTriggered",
    "errorCaptured",
    "serverPrefetch"
];
function build(cons, optionBuilder) {
    var _a, _b;
    const slot = (0, utils_1.obtainSlot)(cons.prototype);
    const protoArr = (0, utils_2.toComponentReverse)(cons.prototype);
    (_a = optionBuilder.lifecycle) !== null && _a !== void 0 ? _a : (optionBuilder.lifecycle = {});
    (_b = optionBuilder.methods) !== null && _b !== void 0 ? _b : (optionBuilder.methods = {});
    const LifecycleFunctions = {};
    const MethodFunctions = {};
    protoArr.forEach(proto => {
        (0, utils_2.excludeNames)((0, utils_2.getValidNames)(proto, (des, name) => {
            if (name === 'constructor') {
                return false;
            }
            if (typeof des.value === 'function') {
                return true;
            }
            return false;
        }), slot).forEach(name => {
            if (exports.LifecycleNames.includes(name)) {
                LifecycleFunctions[name] = proto[name];
            }
            else {
                MethodFunctions[name] = proto[name];
            }
        });
    });
    Object.assign(optionBuilder.methods, MethodFunctions);
    const bccbs = optionBuilder.beforeCreateCallbacks;
    if (bccbs && bccbs.length > 0) {
        const oldBc = LifecycleFunctions['beforeCreate'];
        LifecycleFunctions['beforeCreate'] = function () {
            bccbs.forEach(bccb => bccb.apply(this, arguments));
            if (oldBc) {
                oldBc.apply(this, arguments);
            }
        };
    }
    Object.assign(optionBuilder.lifecycle, LifecycleFunctions);
}
exports.build = build;
//# sourceMappingURL=methodsAndLifecycle.js.map