import "./chunk-XDLP7SDN.js";
import {
  createCommentVNode,
  createElementBlock,
  defineComponent,
  normalizeClass,
  onMounted,
  openBlock,
  reactive,
  ref,
  renderSlot,
  unref,
  useSlots,
  watch
} from "./chunk-XFD2A5SJ.js";
import "./chunk-OL3AADLO.js";

// node_modules/vue3-google-login/dist/index.esm.js
var u = Object.freeze({ __proto__: null });
var g = { library: "https://accounts.google.com/gsi/client", defaultButtonConfig: { theme: "outline", size: "large" }, scopes: "email profile openid" };
var f = reactive({ clientId: null, popupType: "CODE", prompt: false, autoLogin: false, idConfiguration: null, buttonConfig: g.defaultButtonConfig, callback: () => {
}, error: null });
var b = reactive({ apiLoaded: false, apiLoadIntitited: false });
var m = (e) => {
  try {
    const t = e.split(".")[1].replace(/-/g, "+").replace(/_/g, "/"), i = decodeURIComponent(atob(t).split("").map(function(e2) {
      return "%" + ("00" + e2.charCodeAt(0).toString(16)).slice(-2);
    }).join(""));
    return JSON.parse(i);
  } catch (e2) {
    throw "JWT provided is invalid";
  }
};
var I = new Promise((e) => {
  const t = typeof process == "undefined" || process.client == null || process.client;
  if (!b.apiLoadIntitited && t) {
    const t2 = document.createElement("script");
    b.apiLoadIntitited = true, t2.addEventListener("load", () => {
      b.apiLoaded = true, e(window.google);
    }), t2.src = g.library, t2.async = true, t2.defer = true, document.head.appendChild(t2);
  }
});
var w = (e) => {
  b.apiLoadIntitited ? b.apiLoaded ? e(window.google) : watch(() => b.apiLoaded, (t) => {
    t && e(window.google);
  }) : I.then((t) => {
    e(t);
  });
};
var y = (e, t, i, n) => {
  if (!e.client_id)
    throw new Error("Prop client id required since plugin is not initialized with a client id");
  w(() => {
    ((e2, t2, i2, n2, o) => {
      if (o) {
        const t3 = e2.callback;
        e2.callback = (e3) => {
          e3.credential ? t3 && t3(e3) : o(e3);
        };
      }
      window.google.accounts.id.initialize(e2);
      const l = t2.value;
      l && !n2 && window.google.accounts.id.renderButton(l, i2);
    })(e, t, i.buttonConfig, n, i.error), i.prompt && C({ clientId: i.clientId, callback: i.callback, error: i.error, autoLogin: i.autoLogin });
  });
};
var k = (e) => new Promise((t, i) => {
  w((n) => {
    if (!(e && e.clientId || f.clientId))
      throw new Error("clientId is required since the plugin is not initialized with a Client Id");
    n.accounts.oauth2.initCodeClient({ client_id: e && e.clientId || f.clientId || "", scope: g.scopes, ux_mode: "popup", callback: (e2) => {
      e2.code ? t(e2) : i(e2);
    } }).requestCode();
  });
});
var h = (e) => new Promise((t, i) => {
  w((n) => {
    if (!(e && e.clientId || f.clientId))
      throw new Error("clientId is required since the plugin is not initialized with a Client Id");
    n.accounts.oauth2.initTokenClient({ client_id: e && e.clientId || f.clientId || "", scope: g.scopes, callback: (e2) => {
      e2.access_token ? t(e2) : i(e2);
    } }).requestAccessToken();
  });
});
var C = (e) => {
  if (!e && (e = {}), !e.clientId && !f.clientId)
    throw new Error("clientId is required");
  const t = {};
  return e.clientId && (t.client_id = e.clientId), !e.clientId && f.clientId && (t.client_id = f.clientId), e.context && (t.context = e.context), e.autoLogin != null && (t.auto_select = e.autoLogin), e.cancelOnTapOutside != null && (t.cancel_on_tap_outside = e.cancelOnTapOutside), new Promise((i, n) => {
    t.callback = (t2) => {
      e && e.callback && e.callback(t2), t2.credential ? i(t2) : n(t2);
    }, w((i2) => {
      i2.accounts.id.initialize(t), i2.accounts.id.prompt((t2) => {
        e && e.onNotification && e.onNotification(t2), ((e2) => {
          const t3 = e2.notification;
          let i3 = "";
          t3.isNotDisplayed() && (i3 = t3.getNotDisplayedReason() === "suppressed_by_user" ? "Prompt was suppressed by user'. Refer https://developers.google.com/identity/gsi/web/guides/features#exponential_cooldown for more info" : `Prompt was not displayed, reason for not displaying: ${t3.getNotDisplayedReason()}`), t3.isSkippedMoment() && (i3 = `Prompt was skipped, reason for skipping: ${t3.getSkippedReason()}`), i3.length && (e2.error ? e2.error(i3) : e2.reject(i3));
        })({ notification: t2, reject: n, error: e && e.error });
      });
    });
  });
};
var _ = () => {
  w((e) => {
    e.accounts.id.disableAutoSelect();
  });
};
var L = defineComponent({ name: "GoogleLogin", props: { clientId: { type: String, required: false }, prompt: { type: Boolean, required: false, default: false }, autoLogin: { type: Boolean, required: false, default: false }, popupType: { type: String, required: false, default: "CODE" }, idConfiguration: { type: Object, required: false }, buttonConfig: { type: Object, required: false }, callback: { type: Function, required: false }, error: { type: Function, required: false } }, setup(e) {
  const t = e, i = !!useSlots().default, u2 = ((e2, t2) => {
    const i2 = { ...e2 };
    for (const e3 in t2)
      t2[e3] !== void 0 && t2[e3] !== null && (i2[e3] = t2[e3]);
    return i2;
  })(f, t), g2 = { client_id: u2.clientId || null, auto_select: u2.autoLogin || false, callback: u2.callback, ...u2.idConfiguration }, m2 = ref();
  return onMounted(() => {
    y(g2, m2, u2, i);
  }), (e2, t2) => (openBlock(), createElementBlock("div", { class: normalizeClass(["g-btn-wrapper", [!unref(b).apiLoaded && "api-loading"]]), onClick: t2[0] || (t2[0] = (e3) => unref(i) && void (unref(u2).popupType === "TOKEN" ? h({ clientId: u2.clientId }).then((e4) => {
    u2.callback && u2.callback(e4);
  }) : k({ clientId: u2.clientId }).then((e4) => {
    u2.callback && u2.callback(e4);
  }))) }, [unref(i) ? createCommentVNode("v-if", true) : (openBlock(), createElementBlock("span", { key: 0, ref_key: "buttonRef", ref: m2, class: "g-btn" }, null, 512)), renderSlot(e2.$slots, "default")], 2));
} });
!function(e, t) {
  t === void 0 && (t = {});
  var i = t.insertAt;
  if (e && typeof document != "undefined") {
    var n = document.head || document.getElementsByTagName("head")[0], o = document.createElement("style");
    o.type = "text/css", i === "top" && n.firstChild ? n.insertBefore(o, n.firstChild) : n.appendChild(o), o.styleSheet ? o.styleSheet.cssText = e : o.appendChild(document.createTextNode(e));
  }
}("\n.g-btn-wrapper[data-v-5e610566] {\n  display: inline-block;\n}\n.g-btn-wrapper.api-loading[data-v-5e610566] {\n  opacity: 0.5;\n  pointer-events: none;\n}\n"), L.__scopeId = "data-v-5e610566", L.__file = "src/plugin/GoogleLogin.vue";
var v = { install: (e, t) => {
  t && ((e2) => {
    e2.clientId && (f.clientId = e2.clientId), e2.popupType && (f.popupType = e2.popupType), e2.prompt != null && (f.prompt = e2.prompt), e2.autoLogin != null && (f.autoLogin = e2.autoLogin), e2.idConfiguration && (f.idConfiguration = e2.idConfiguration), e2.buttonConfig && (f.buttonConfig = e2.buttonConfig), e2.callback && (f.callback = e2.callback);
  })(t), I.then(() => {
    if (t.clientId) {
      const e2 = { client_id: t.clientId, auto_select: t.autoLogin === true, callback: t.callback, ...t.idConfiguration };
      window.google.accounts.id.initialize(e2), t.prompt && window.google.accounts.id.prompt();
    }
  }), e.component("GoogleLogin", L);
} };

// dep:vue3-google-login
var vue3_google_login_default = v;
export {
  u as CallbackTypes,
  L as GoogleLogin,
  m as decodeCredential,
  vue3_google_login_default as default,
  k as googleAuthCodeLogin,
  _ as googleLogout,
  C as googleOneTap,
  w as googleSdkLoaded,
  h as googleTokenLogin
};
//# sourceMappingURL=vue3-google-login.js.map
